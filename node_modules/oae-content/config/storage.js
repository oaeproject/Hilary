/*!
 * Copyright 2012 Sakai Foundation (SF) Licensed under the
 * Educational Community License, Version 2.0 (the "License"); you may
 * not use this file except in compliance with the License. You may
 * obtain a copy of the License at
 *
 *     http://www.osedu.org/licenses/ECL-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

var fs = require('fs');
var mkdirp = require('mkdirp');
var path = require('path');

var Fields = require('oae-config/lib/fields');

// By default, store the uploaded files on the same level as Hilary.
// Create the directory if it doesn't exist already.
var dir = path.join('..', 'files');
if (process.env['OAE_COVERING']) {
    dir = path.join('..', dir);
}
mkdirp.sync(dir);
var localDir = fs.realpathSync(dir);

module.exports = {
    "oae-content": {
        "title": "OAE Content Module",
        "storage": {
            "name": "Storage backend settings",
            "description": "Define the backend storage settings",
            "tenantOverride": true,
            "elements": {
                "backend": new Fields.Radio('Default storage backend', 'Default storage backend for file bodies', 'local', true, [
                    {
                        "name": "Local",
                        "value": "local"
                    },
                    {
                        "name": "Amazon S3",
                        "value": "amazons3"
                    }
                ]),
                "local-dir": new Fields.Text('Directory to write to', 'The (mounted) path to write file bodies in.', localDir, false),
                "amazons3-access-key": new Fields.Text('Amazon Access Key', 'Your Amazon Access key.', '<access-key>', false),
                "amazons3-secret-key": new Fields.Text('Amazon Secret Key', 'Your Amazon Secret key.', '<secret-key>', false),
                "amazons3-region": new Fields.Text('Amazon S3 Region', 'The region for your S3 bucket.', 'us-east-1', false),
                "amazons3-bucket": new Fields.Text('Amazon S3 Bucket', 'The Amazon S3 Bucket to store file bodies in.', 'oae-files', false),
            }
        }
    }
}
