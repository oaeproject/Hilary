var Cassandra = require('oae-util/lib/cassandra');

var userModel = require('./model.js');

/**
 * Creates a new user under this tenant.
 * @param  {Tenant}   tenant    
 * @param  {String}   firstName This user his first name.
 * @param  {String}   lastName  This user his last name
 * @param  {Function} callback  A callback method.
 */
module.exports.createUser = function(tenant, firstName, lastName, callback) {
    var id = "u:" + tenant.alias + ":" + firstName.toLowerCase();

    // Create the group.
    Cassandra.runQuery('INSERT INTO Principals (principal_id, tenant, user_first_name, user_last_name) VALUES (?, ?, ?, ?)', [id, tenant.alias, firstName, lastName], function (err) {
        if (err) {
            callback({'code': 500, 'msg': err}, null);
        } else {
            callback(false, id);
        }
    });
};