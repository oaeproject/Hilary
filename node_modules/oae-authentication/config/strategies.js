/*!
 * Copyright 2012 Sakai Foundation (SF) Licensed under the
 * Educational Community License, Version 2.0 (the "License"); you may
 * not use this file except in compliance with the License. You may
 * obtain a copy of the License at
 *
 *     http://www.osedu.org/licenses/ECL-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an "AS IS"
 * BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express
 * or implied. See the License for the specific language governing
 * permissions and limitations under the License.
 */

var Fields = require('oae-config/lib/fields');

module.exports = {
    'title': 'OAE Authentication Module',
    'local': {
        'name': 'Local Authentication',
        'description': 'Allow local authentication for tenant',
        'elements': {
            'allowAccountCreation': new Fields.Bool('Local Account Creation', 'Allow users to create their own account', true),
            'enabled': new Fields.Bool('Local Authentication Enabled', 'Allow local authentication for tenant', true)
        }
    },
    'google': {
        'name': 'Google Authentication',
        'description': 'Allow Google authentication for tenant',
        'elements': {
            'enabled': new Fields.Bool('Google Authentication Enabled', 'Allow Google authentication for tenant', false),
            'key': new Fields.Text('Google client ID', 'Google client ID', '822036948319.apps.googleusercontent.com', {'suppress': true}),
            'secret': new Fields.Text('Google client secret', 'Google client secret', 'b5ccr5noy0j_gzj4kj42uuwm', {'suppress': true})
        }
    },
    'twitter': {
        'name': 'Twitter Authentication',
        'description': 'Allow Twitter authentication for tenant',
        'elements': {
            'enabled': new Fields.Bool('Twitter Authentication Enabled', 'Allow Twitter authentication for tenant', true),
            'key': new Fields.Text('Twitter consumer key', 'Twitter consumer key', '8eET3GSaCVE5GVd5kZsw', {'suppress': true}),
            'secret': new Fields.Text('Twitter consumer secret', 'Twitter consumer secret', 'OIqx7h36fMWqc0Cb3tUI1jzp7bzCbE2F3zJ0Gladc', {'suppress': true})
        }
    },
    'facebook': {
        'name': 'Facebook Authentication',
        'description': 'Allow Facebook authentication for tenant',
        'elements': {
            'enabled': new Fields.Bool('Facebook Authentication Enabled', 'Allow Facebook authentication for tenant', false),
            'appid': new Fields.Text('Facebook App ID', 'Facebook App ID', '194758077323671', {'suppress': true}),
            'secret': new Fields.Text('Secret', 'Secret', '663d14e7f9ad0baeb4e43390825a659f', {'suppress': true})
        }
    },
    'shibboleth': {
        'name': 'Shibboleth Authentication',
        'description': 'Allow Shibboleth authentication for tenant',
        'tenantOverride': true,
        'elements': {
            'enabled': new Fields.Bool('Shibboleth Authentication Enabled', 'Allow Shibboleth authentication for tenant', false),
            'name': new Fields.Text('Name', 'A name that users will recognize as their identity provider', ''),
            'idpUrl': new Fields.Text('Identity Provider URL', 'The URL where users should be redirected to. Usually ends in /Redirect/SSO', '', {'suppress': true}),
            'idpPublicKey': new Fields.Text('Identity Provider public key', 'The public key that the IdP uses to sign SingleSignOnService (HTTP-POST) messages ', '', {'suppress': true}),
            'spEntityID': new Fields.Text('Issuer', 'The entity ID under which this application can access the Identity Provider.', '', {'suppress': true}),
            'spCertificate': new Fields.Text('Certificate', 'Your X509 certificate', '', {'suppress': true, 'globalAdminOnly': true}),
            'spCertificateSubjectName': new Fields.Text('Certificate subject name', 'Your X509 certificate subject name', '', {'suppress': true, 'globalAdminOnly': true}),
            'spPrivateKey': new Fields.Text('Private Key', 'A private key that can be used to sign messages', '', {'suppress': true, 'globalAdminOnly': true})
        }
    },
    'cas': {
        'name': 'CAS Authentication',
        'description': 'Allow CAS authentication for tenant',
        'tenantOverride': true,
        'elements': {
            'enabled': new Fields.Bool('CAS Authentication Enabled', 'Allow CAS authentication for tenant', false),
            'name': new Fields.Text('Name', 'A name that users will recognize as their identity provider', ''),
            'host': new Fields.Text('Host', 'The URI at which the CAS server can be reached (this should include http(s):// and have no trailing slash)', '', {'suppress': true}),
            'basepath': new Fields.Text('Base path', 'The base path on the CAS authentication server. ex: /cas', '', {'suppress': true}),
            'loginpath': new Fields.Text('Login path', 'The path where the user should be redirected to when logging in.', '/login', {'suppress': true}),
            'logoutpath': new Fields.Text('Logout path', 'The path where the user should be redirected to when logging out.', '/logout', {'suppress': true}),
            'validatepath': new Fields.Text('Validate path', 'The path that can be used to validate a ticket.', '/serviceValidate', {'suppress': true})
        }
    },
    'signed': {
        'name': 'Signed authentication',
        'description': 'Expresses how long a token is valid in milliseconds',
        'elements': {
            'expires': new Fields.Text('Expires', 'Expresses how long a token is valid in milliseconds', '120000', {'suppress': true, 'tenantOverride': false})
        }
    }
};
